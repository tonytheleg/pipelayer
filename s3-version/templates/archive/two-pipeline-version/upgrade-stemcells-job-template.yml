- name: update-stemcells
  plan:
  - get: stemcell-xenial-97
    trigger: true
    params:
      globs:
      - "*vsphere*"
  - get: stemcell-xenial-170
    trigger: true
    params:
      globs:
      - "*vsphere*"
    tags: [backups]
  - get: platform-automation-image
    params:
      unpack: true
    tags: [backups]
  - get: platform-automation-tasks
    params:
      unpack: true
    tags: [backups]
  - get: pcf-tile-configurator
    tags: [backups]

  - task: upload-xenial-97-stemcells
    image: platform-automation-image
    file: platform-automation-tasks/tasks/upload-stemcell.yml
    input_mapping:
      env: pcf-tile-configurator
      stemcell: stemcell-xenial-97
    params:
      ENV_FILE: envs/INSERT_FOUNDATION_HERE
      FLOATING_STEMCELL: true
  
  - task: upload-xenial-170-stemcells
    image: platform-automation-image
    file: platform-automation-tasks/tasks/upload-stemcell.yml
    input_mapping:
      env: pcf-tile-configurator
      stemcell: stemcell-xenial-170
    params:
      ENV_FILE: envs/INSERT_FOUNDATION_HERE
